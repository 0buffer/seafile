<%inherit file="base.html"/>

<%def name="main_panel()"> 
<div class="narrow-panel">
% if repo_already_exists:
<p>${_("Repo already exists.")}</p>
% else:
<h3>${_("You are going to synchronize")}<em>${repo_name}</em></h3>
<form action="/repo/download/" method="post">
    <input type="hidden" name="repo_id" value="${repo_id}" />
    <input type="hidden" name="relay_id" value="${relay_id}" />
    <input type="hidden" name="repo_name" value="${repo_name}" />
    <input type="hidden" name="encrypted" value="${encrypted}" />
    <input type="hidden" name="relay_id" value="${relay_id}" />
    <input type="hidden" name="relay_addr" value="${relay_addr}" />
    <input type="hidden" name="relay_port" value="${relay_port}" />
    <input type="hidden" name="token" value="${token}" />
    <input type="hidden" name="email" value="${email}" />
    <p><em>${repo_name}</em> ${_("will be synced with:")}</p>
    <div id="wt">
      <input type="hidden" name="worktree" value="${worktree}" />
      <p>${worktree} <img src="/static/img/edit_12.png" alt="${_('modify')}" title="${_('modify')}" class="click" id="change-wt"/></p>
    </div>
    % if encrypted:
    <p class="encrypted">${_("This repo is encrypted. Please enter the password for decrypting:")}</p>
    <input type="password" name="password" maxlength="64" class="text-input" /><br/>
    % endif
    % if error_msg:
    <p class="error">${ error_msg }</p>
    % endif
    <input type="submit" value="${_("OK")}" class="submit" />
</form>
% endif
</div>
</%def>

<%def name="js()">
% if not repo_already_exists:
<script type="text/javascript">

$('#change-wt').click(function() {
    $('#wt').html('<input type="text" name="worktree" value="${worktree.replace('\\', '\\\\')}" class="text-input" />');
});

</script>
% endif
</%def>

