<%inherit file="base.html"/>

<%!
    from utils import translate_time_sec
    from utils import format_file_size
%>

<%def name="left_panel()">
<div class="left-nav">
% if relays:
<h3>${_("Servers")}</h3>
% endif
% for relay in relays:
    <p><a class="relay-link" href="${relay.props.service_url}">${relay.props.name}</a>
    % if relay.props.is_ready:
    ${_("connected")}
    % elif relay.props.net_state == 1:
    ${_("authenticating")}
    % else:
    ${_("not connected")}
    % endif
    </p>
% endfor

<h3>${_("Navigation")}</h3>

<ul class="home-op-list">
    <li><a href="/repos/download-tasks/">${_("View Download Tasks")}</a></li>
</ul>

<h3>${_("Official Server")}</h3>
<a href="http://cloud.seafile.com.cn" target="_blank">SeaCloud</a>

</div>
</%def>

<%def name="wide_center_panel()">

% if len(repos) == 0:
<h3>${_("Four Steps to Use Seafile Client")}</h3>
<ol>
    <li>${_("Login into an seafile server, either our official server (SeaCloud) or your private server.")}</li>
    <li>${_("Create a library on server.")}</li>
    <li>${_("Download the library.")}</li>
    <li>${_("Add files to the folder and they will be uploaded automatically.")}</li>
</ol>

% else:
<h3>${_("All Librarys")}</h3>
<table class="repo-list">
    <tr>
        <th width="20%">${_("Name")}</th>
        <th width="7%">${_("Action")}</th>
        <th width="32%">${_("Description")}</th>
        <th width="12%">${_("Server")}</th>
        <th width="17%">${_("Modify Time")}</th>
        <th width="12%">${_("State")}</th>
    </tr>
    % for repo in repos:
    <tr>
        <td><a href="/repo/?repo=${repo.props.id}" class="repo-link">${ repo.props.name }</a></td>
        <td>
            <a class="opendir-link" href="/repos/operation/?repo=${repo.props.id}&op=open">${_("Open")}</a>
        </td>
        <td>${ repo.props.desc }</td>
        <td>
            % if repo.relay:
            ${ repo.relay.name }
            % endif
        <td>
            % if repo.props.last_modify:
                % if repo.props.last_modify > 0:
                    ${repo.props.last_modify | translate_time_sec}
                % else:
                    ${_("Unknown")}
                % endif
            % else:
                ${_("Unknown")}
            % endif
        <td>
            % if repo.sync_info and repo.local_branch:
                % if repo.sync_info.props.head_commit == repo.local_branch.props.commit_id:
                ${_("Synchronized")}
                % endif
            % endif
        </td>
    </tr>
    % endfor
</table>
% endif
</%def>
